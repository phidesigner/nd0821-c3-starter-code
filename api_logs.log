2025-01-08 14:34:57,374 - INFO - Model and artifacts loaded successfully.
2025-01-08 14:35:05,960 - INFO - Incoming request: {'age': 34, 'workclass': 'Private', 'education': 'Bachelors', 'marital_status': 'Married-civ-spouse', 'occupation': 'Prof-specialty', 'relationship': 'Husband', 'race': 'White', 'sex': 'Male', 'native_country': 'United-States', 'capital_gain': 0, 'capital_loss': 0, 'hours_per_week': 40}
2025-01-08 14:35:05,960 - INFO - Formatted input data: {'age': [34], 'workclass': ['Private'], 'education': ['Bachelors'], 'marital-status': ['Married-civ-spouse'], 'occupation': ['Prof-specialty'], 'relationship': ['Husband'], 'race': ['White'], 'sex': ['Male'], 'native-country': ['United-States'], 'capital-gain': [0], 'capital-loss': [0], 'hours-per-week': [40]}
2025-01-08 14:35:05,960 - ERROR - Error during prediction: unhashable type: 'list'
Traceback (most recent call last):
  File "/workspaces/nd0821-c3-starter-code/starter/main.py", line 136, in predict_income
    X, _, _, _ = process_data(
                 ^^^^^^^^^^^^^
  File "/workspaces/nd0821-c3-starter-code/starter/ml/data.py", line 65, in process_data
    X_categorical = X[categorical_features]
                    ~^^^^^^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'list'
2025-01-08 14:37:27,297 - INFO - Model and artifacts loaded successfully.
2025-01-08 14:37:33,643 - INFO - Formatted input data: {'age': [34], 'workclass': ['Private'], 'education': ['Bachelors'], 'marital-status': ['Married-civ-spouse'], 'occupation': ['Prof-specialty'], 'relationship': ['Husband'], 'race': ['White'], 'sex': ['Male'], 'native-country': ['United-States'], 'capital-gain': [0], 'capital-loss': [0], 'hours-per-week': [40]}
2025-01-08 14:37:33,643 - ERROR - Error during prediction: name 'pd' is not defined
Traceback (most recent call last):
  File "/workspaces/nd0821-c3-starter-code/starter/main.py", line 123, in predict_income
    input_df = pd.DataFrame(input_data)
               ^^
NameError: name 'pd' is not defined
2025-01-08 14:38:13,847 - INFO - Model and artifacts loaded successfully.
2025-01-08 14:38:20,818 - INFO - Formatted input data: {'age': [34], 'workclass': ['Private'], 'education': ['Bachelors'], 'marital-status': ['Married-civ-spouse'], 'occupation': ['Prof-specialty'], 'relationship': ['Husband'], 'race': ['White'], 'sex': ['Male'], 'native-country': ['United-States'], 'capital-gain': [0], 'capital-loss': [0], 'hours-per-week': [40]}
2025-01-08 14:38:20,832 - INFO - Input data converted to DataFrame:    age workclass  education      marital-status      occupation relationship   race   sex native-country  capital-gain  capital-loss  hours-per-week
0   34   Private  Bachelors  Married-civ-spouse  Prof-specialty      Husband  White  Male  United-States             0             0              40
2025-01-08 14:38:20,892 - INFO - Processed input: [[34.  0.  0. 40.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.
   0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.
   0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  1.  0.  0.
   0.  0.  0.  0.  0.  0.  0.  1.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.
   0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
   0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.]]
2025-01-08 14:38:20,894 - ERROR - Error during prediction: X has 106 features, but RandomForestClassifier is expecting 108 features as input.
Traceback (most recent call last):
  File "/workspaces/nd0821-c3-starter-code/starter/main.py", line 149, in predict_income
    prediction = model.predict(X)
                 ^^^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/sklearn/ensemble/_forest.py", line 904, in predict
    proba = self.predict_proba(X)
            ^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/sklearn/ensemble/_forest.py", line 946, in predict_proba
    X = self._validate_X_predict(X)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/sklearn/ensemble/_forest.py", line 638, in _validate_X_predict
    X = validate_data(
        ^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2965, in validate_data
    _check_n_features(_estimator, X, reset=reset)
  File "/home/codespace/.local/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2829, in _check_n_features
    raise ValueError(
ValueError: X has 106 features, but RandomForestClassifier is expecting 108 features as input.
2025-01-08 14:57:49,761 - INFO - Model and artifacts loaded successfully.
2025-01-08 14:58:04,420 - INFO - Formatted input data: {'age': [34], 'workclass': ['Private'], 'education': ['Bachelors'], 'marital-status': ['Married-civ-spouse'], 'occupation': ['Prof-specialty'], 'relationship': ['Husband'], 'race': ['White'], 'sex': ['Male'], 'native-country': ['United-States'], 'education-num': [13], 'fnlgt': [77516], 'capital-gain': [0], 'capital-loss': [0], 'hours-per-week': [40]}
2025-01-08 14:58:04,421 - INFO - Input data converted to DataFrame:    age workclass  education      marital-status      occupation  ... education-num  fnlgt capital-gain capital-loss  hours-per-week
0   34   Private  Bachelors  Married-civ-spouse  Prof-specialty  ...            13  77516            0            0              40

[1 rows x 14 columns]
2025-01-08 14:58:04,444 - INFO - Processed input: [[3.4000e+01 1.3000e+01 7.7516e+04 0.0000e+00 0.0000e+00 4.0000e+01
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 1.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  1.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 1.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  1.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 1.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 1.0000e+00 0.0000e+00 1.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00
  0.0000e+00 0.0000e+00 0.0000e+00 1.0000e+00 0.0000e+00 0.0000e+00]]
2025-01-08 14:58:04,470 - INFO - Predicted class: <=50K
